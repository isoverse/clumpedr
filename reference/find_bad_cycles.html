<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Find bad cycles based on several criteria. — find_bad_cycles • clumpedr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Find bad cycles based on several criteria. — find_bad_cycles"><meta property="og:description" content='This function tries to identify cycles in which the pressure has dropped
fast. It first disables all the cycles above or below certain thresholds
(min, max), and then calculates whether the next cycle has dropped by
more than fac times either the initial (relative to = "init", default)
or the previous (relative_to = "prev") cycle.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clumpedr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/clumped.html">Using clumpedr: basic data analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/isoverse/clumpedr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find bad cycles based on several criteria.</h1>
    <small class="dont-index">Source: <a href="https://github.com/isoverse/clumpedr/blob/master/R/find_bad_cycles.R" class="external-link"><code>R/find_bad_cycles.R</code></a></small>
    <div class="hidden name"><code>find_bad_cycles.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function tries to identify cycles in which the pressure has dropped
fast. It first disables all the cycles above or below certain thresholds
(<code>min</code>, <code>max</code>), and then calculates whether the next cycle has dropped by
more than <code>fac</code> times either the initial (<code>relative to = "init"</code>, default)
or the previous (<code>relative_to = "prev"</code>) cycle.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_bad_cycles</span><span class="op">(</span></span>
<span>  <span class="va">.data</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">min</span>,</span>
<span>  <span class="va">max</span>,</span>
<span>  <span class="va">fac</span>,</span>
<span>  v44 <span class="op">=</span> <span class="st">"v44.mV"</span>,</span>
<span>  cycle <span class="op">=</span> <span class="st">"cycle"</span>,</span>
<span>  relative_to <span class="op">=</span> <span class="st">"init"</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>A <a href="https://tibble.tidyverse.org/reference/tibble-package.html" class="external-link">tibble</a>, resulting from
<code><a href="http://isoreader.isoverse.org/reference/iso_get_raw_data.html" class="external-link">isoreader::iso_get_raw_data()</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-min">min<a class="anchor" aria-label="anchor" href="#arg-min"></a></dt>
<dd><p>Minimum intensity level for good cycles. Defaults to 1,500 mV.</p></dd>


<dt id="arg-max">max<a class="anchor" aria-label="anchor" href="#arg-max"></a></dt>
<dd><p>Maximum intensity level for good cycles. Defaults to 50,000 mV.</p></dd>


<dt id="arg-fac">fac<a class="anchor" aria-label="anchor" href="#arg-fac"></a></dt>
<dd><p>Factor for how much larger the current drop should be than the
one specified in <code>relative_to</code>.</p></dd>


<dt id="arg-v-">v44<a class="anchor" aria-label="anchor" href="#arg-v-"></a></dt>
<dd><p>Column name of mass 44.</p></dd>


<dt id="arg-cycle">cycle<a class="anchor" aria-label="anchor" href="#arg-cycle"></a></dt>
<dd><p>Column name of the column with the measurement cycle number.</p></dd>


<dt id="arg-relative-to">relative_to<a class="anchor" aria-label="anchor" href="#arg-relative-to"></a></dt>
<dd><p>cycle Drop detection occurs relative to either the first
cycle ("init", default) or to the previous cycle ("prev").</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>If <code>TRUE</code>, print info messages. If <code>NULL</code> (default) listens to <code>options(clumpedr.quiet)</code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Same as <code>.data</code> but with some new columns that allow us to disable
certain cycles/whole samples.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The drop in intensity can be defined relative to the first change
in intensity (default), or to the previous cycle.</p>
<p>Note that the min, max, and fac input parameters must be columns in the
input data, so that reproducibility is guaranteed.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># get the raw data from the example dataset</span></span></span>
<span class="r-in"><span><span class="fu">isoreader</span><span class="fu">::</span><span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_get_raw_data.html" class="external-link">iso_get_raw_data</a></span><span class="op">(</span><span class="va">standards</span>, include_file_info <span class="op">=</span> <span class="st">"Analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># add new columns with criteria</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dis_min <span class="op">=</span> <span class="fl">500</span>, dis_max <span class="op">=</span> <span class="fl">50000</span>, dis_fac <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">find_bad_cycles</span><span class="op">(</span>min <span class="op">=</span> <span class="st">"dis_min"</span>, max <span class="op">=</span> <span class="st">"dis_max"</span>,</span></span>
<span class="r-in"><span>                  fac <span class="op">=</span> <span class="st">"dis_fac"</span>, relative_to <span class="op">=</span> <span class="st">"init"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Info: aggregating raw data from 27 data file(s), including file info '"Analysis"'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Info: found 0 out of 27 acquisitions with a drop in pressure of mass 44.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,187 × 23</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    file_id Analysis type  cycle v44.mV v45.mV v46.mV v47.mV v48.mV v49.mV v54.mV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> 180814… 4841     stan…     0 <span style="text-decoration: underline;">16</span>647. <span style="text-decoration: underline;">19</span>675. <span style="text-decoration: underline;">23</span>072. <span style="text-decoration: underline;">25</span>664.  <span style="text-decoration: underline;">2</span>124.  -<span style="color: #BB0000;">268.</span>  -<span style="color: #BB0000;">270.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> 180814… 4841     stan…     1 <span style="text-decoration: underline;">16</span>406. <span style="text-decoration: underline;">19</span>391. <span style="text-decoration: underline;">22</span>738. <span style="text-decoration: underline;">25</span>293.  <span style="text-decoration: underline;">2</span>094.  -<span style="color: #BB0000;">264.</span>  -<span style="color: #BB0000;">265.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> 180814… 4841     stan…     2 <span style="text-decoration: underline;">16</span>153. <span style="text-decoration: underline;">19</span>091. <span style="text-decoration: underline;">22</span>387. <span style="text-decoration: underline;">24</span>899.  <span style="text-decoration: underline;">2</span>062.  -<span style="color: #BB0000;">259.</span>  -<span style="color: #BB0000;">261.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> 180814… 4841     stan…     3 <span style="text-decoration: underline;">15</span>891. <span style="text-decoration: underline;">18</span>782. <span style="text-decoration: underline;">22</span>024. <span style="text-decoration: underline;">24</span>502.  <span style="text-decoration: underline;">2</span>029.  -<span style="color: #BB0000;">255.</span>  -<span style="color: #BB0000;">257.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> 180814… 4841     stan…     4 <span style="text-decoration: underline;">15</span>631. <span style="text-decoration: underline;">18</span>476. <span style="text-decoration: underline;">21</span>665. <span style="text-decoration: underline;">24</span>100.  <span style="text-decoration: underline;">1</span>997.  -<span style="color: #BB0000;">250.</span>  -<span style="color: #BB0000;">252.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> 180814… 4841     stan…     5 <span style="text-decoration: underline;">15</span>383. <span style="text-decoration: underline;">18</span>182. <span style="text-decoration: underline;">21</span>321. <span style="text-decoration: underline;">23</span>717.  <span style="text-decoration: underline;">1</span>964.  -<span style="color: #BB0000;">246.</span>  -<span style="color: #BB0000;">249.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> 180814… 4841     stan…     6 <span style="text-decoration: underline;">15</span>135. <span style="text-decoration: underline;">17</span>889. <span style="text-decoration: underline;">20</span>978. <span style="text-decoration: underline;">23</span>336.  <span style="text-decoration: underline;">1</span>934.  -<span style="color: #BB0000;">241.</span>  -<span style="color: #BB0000;">244.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> 180814… 4841     stan…     7 <span style="text-decoration: underline;">14</span>892. <span style="text-decoration: underline;">17</span>603. <span style="text-decoration: underline;">20</span>641. <span style="text-decoration: underline;">22</span>959.  <span style="text-decoration: underline;">1</span>903.  -<span style="color: #BB0000;">237.</span>  -<span style="color: #BB0000;">240.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> 180814… 4841     stan…     8 <span style="text-decoration: underline;">14</span>656. <span style="text-decoration: underline;">17</span>323. <span style="text-decoration: underline;">20</span>313. <span style="text-decoration: underline;">22</span>600.  <span style="text-decoration: underline;">1</span>873.  -<span style="color: #BB0000;">234.</span>  -<span style="color: #BB0000;">236.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> 180814… 4841     stan…     9 <span style="text-decoration: underline;">14</span>422. <span style="text-decoration: underline;">17</span>047. <span style="text-decoration: underline;">19</span>990. <span style="text-decoration: underline;">22</span>234.  <span style="text-decoration: underline;">1</span>844.  -<span style="color: #BB0000;">229.</span>  -<span style="color: #BB0000;">232.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,177 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 12 more variables: dis_min &lt;dbl&gt;, dis_max &lt;dbl&gt;, dis_fac &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   outlier_cycle_low &lt;lgl&gt;, outlier_cycle_high &lt;lgl&gt;, cycle_diff &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   first_diff_fac &lt;dbl&gt;, cycle_drop &lt;lgl&gt;, cycle_has_drop &lt;lgl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   cycle_drop_num &lt;int&gt;, outlier_cycle_drop &lt;lgl&gt;, outlier_cycle &lt;lgl&gt;</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ilja Kocken.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

