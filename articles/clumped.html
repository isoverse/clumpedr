<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using clumpedr: basic data analysis â€¢ clumpedr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using clumpedr: basic data analysis">
<meta property="og:description" content="clumpedr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clumpedr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/clumped.html">Using clumpedr: basic data analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/isoverse/clumpedr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using clumpedr: basic data analysis</h1>
                        <h4 data-toc-skip class="author">Ilja J.
Kocken</h4>
            
            <h4 data-toc-skip class="date">2019-11-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/isoverse/clumpedr/blob/HEAD/vignettes/clumped.Rmd" class="external-link"><code>vignettes/clumped.Rmd</code></a></small>
      <div class="hidden name"><code>clumped.Rmd</code></div>

    </div>

    
    
<p>Once you have <code>clumpedr</code> installed (see the README), you
can first load the libraries:</p>
<div class="section level2">
<h2 id="load-the-packages-that-we-use">load the packages that we use<a class="anchor" aria-label="anchor" href="#load-the-packages-that-we-use"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># library(tidyverse)  # a few of the below and many more</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/" class="external-link">glue</a></span><span class="op">)</span>      <span class="co"># optional, if you want to glue strings together</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>     <span class="co"># for pipes, mutate, summarise, etc.</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>     <span class="co"># for nesting/unnesting</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>   <span class="co"># for plots!</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://isoreader.isoverse.org" class="external-link">isoreader</a></span><span class="op">)</span> <span class="co"># read in raw data</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'isoreader'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/isoverse/clumpedr" class="external-link">clumpedr</a></span><span class="op">)</span>  <span class="co"># this package! process clumped isotope data</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="get-your-data-from-raw-instrument-data-into-r">get your data from raw instrument data into R<a class="anchor" aria-label="anchor" href="#get-your-data-from-raw-instrument-data-into-r"></a>
</h2>
<div class="section level3">
<h3 id="load-data-from-a-remote">load data from a remote<a class="anchor" aria-label="anchor" href="#load-data-from-a-remote"></a>
</h3>
<p>First locate where you have your raw data files stored.</p>
<p>Here I show how I load data from a remote Windows samba server on my
GNU/Linux machine.</p>
<p>Of course you can also just copy your files and paste them in a
folder you desire.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">folderstr</span> <span class="op">&lt;-</span> <span class="st">"/run/user/1000/gvfs/smb-share:server=geofile02.geo.uu.nl,share=geo-labs/@RawData"</span></span>
<span><span class="co"># read all did files</span></span>
<span><span class="va">dids</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_read_dual_inlet.html" class="external-link">iso_read_dual_inlet</a></span><span class="op">(</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue</a></span><span class="op">(</span><span class="st">"{folderstr}/253pluskiel/Raw Data/Kiel Raw Data"</span><span class="op">)</span>,</span>
<span>                            cache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            discard_duplicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                            parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>It is nice to save a cache/backup as an R data structure file, which
we can read in much faster.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_save.html" class="external-link">iso_save</a></span><span class="op">(</span><span class="va">dids</span>, <span class="st">"out/dids.di.rds"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-from-the-cache">load from the cache<a class="anchor" aria-label="anchor" href="#load-from-the-cache"></a>
</h3>
<p>Once we have saved the r data storage (<code>.rds</code>) file, we
can load it much faster than the raw data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dids</span>  <span class="op">&lt;-</span> <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_read_dual_inlet.html" class="external-link">iso_read_dual_inlet</a></span><span class="op">(</span><span class="st">"out/dids.di.rds"</span><span class="op">)</span></span></code></pre></div>
<p>I have made some standard data available here so as to run the tests,
or a single did file for an ETH-3 standard.</p>
<p>See their documentation with the following code:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">standards</span></span>
<span><span class="op">?</span><span class="va">eth3</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="process-the-data">process the data!<a class="anchor" aria-label="anchor" href="#process-the-data"></a>
</h2>
<p>We save the file info separately, since we will have to refer to it
for some plots.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdinfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_get_file_info.html" class="external-link">iso_get_file_info</a></span><span class="op">(</span><span class="va">standards</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: aggregating file info from 27 data file(s)</span></span></code></pre>
<p>This would also be the place to add potential fixes to typos in the
file info using <code><a href="http://isoreader.isoverse.org/reference/iso_mutate_file_info.html" class="external-link">isoreader::iso_mutate_file_info()</a></code>.</p>
<div class="section level3">
<h3 id="run-the-processing-step-by-step">run the processing step-by-step<a class="anchor" aria-label="anchor" href="#run-the-processing-step-by-step"></a>
</h3>
<p>Note that normally, it is faster and smarter not to save the output
of every step as a separate tibble, but in this case we do it so that we
can easily inspect the results along the way. See the end of the
vignette for the single pipe.</p>
<div class="section level4">
<h4 id="filter-measurements-of-interest">filter measurements of interest<a class="anchor" aria-label="anchor" href="#filter-measurements-of-interest"></a>
</h4>
<p>First we filter out the measurements we want, based on the Method
name.</p>
<p>We use a regular expression, or <code>regexp</code>. They are very
useful ways of looking for patterns in strings.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">filt</span> <span class="op">&lt;-</span> <span class="va">standards</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># we can subset to some files of interest (e.g., based on a regular expression)</span></span>
<span>  <span class="co"># in this case we subset to all the runs that have a "Clumped" method.</span></span>
<span>  <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_filter_files.html" class="external-link">iso_filter_files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Clumped.*met"</span>, <span class="va">Method</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: applying file filter, keeping 27 of 27 files</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="extract-raw-data">extract raw data<a class="anchor" aria-label="anchor" href="#extract-raw-data"></a>
</h4>
<p>Then we extract the raw data. This gives it in a format where each
row is one cycle of either <code>standard</code> or <code>sample</code>
gas, with initensities 44â€“49 as columns.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rawd</span> <span class="op">&lt;-</span> <span class="va">filt</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># get all the raw data, per cycle from the dids</span></span>
<span>  <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_get_raw_data.html" class="external-link">iso_get_raw_data</a></span><span class="op">(</span>include_file_info <span class="op">=</span> <span class="st">"Analysis"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: aggregating raw data from 27 data file(s), including file info '"Analysis"'</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="disable-failed-cycles">disable failed cycles<a class="anchor" aria-label="anchor" href="#disable-failed-cycles"></a>
</h4>
<p>This disables any cycles that have a sudden drop in
pressure/intensity.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">disc</span> <span class="op">&lt;-</span> <span class="va">rawd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dis_min <span class="op">=</span> <span class="fl">500</span>, dis_max <span class="op">=</span> <span class="fl">50000</span>, dis_fac <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/find_bad_cycles.html">find_bad_cycles</a></span><span class="op">(</span>min <span class="op">=</span> <span class="va">dis_min</span>, max <span class="op">=</span> <span class="va">dis_max</span>,</span>
<span>                  fac <span class="op">=</span> <span class="va">dis_fac</span>, relative_to <span class="op">=</span> <span class="st">"init"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'dis_min' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="find-initial-intensities-of-each-cycle">find initial intensities of each cycle<a class="anchor" aria-label="anchor" href="#find-initial-intensities-of-each-cycle"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_inits.html">get_inits</a></span><span class="op">(</span><span class="va">rawd</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="background-correction">background correction<a class="anchor" aria-label="anchor" href="#background-correction"></a>
</h4>
<p>Do a very simple background correction based on the half-cup mass
54.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bgds</span> <span class="op">&lt;-</span> <span class="va">disc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/correct_backgrounds.html">correct_backgrounds</a></span><span class="op">(</span>factor <span class="op">=</span> <span class="fl">0.82</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: adding background based on half-mass with factor 0.82</span></span></code></pre>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'disc' not found</span></span></code></pre>
<p>For a background correction based on background scans performed
before each run we have to get the raw scan data into R.</p>
<p>We can do this with:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">scns</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_read_scan.html" class="external-link">iso_read_scan</a></span><span class="op">(</span><span class="st">"scan_file.scn"</span>, cache <span class="op">=</span> <span class="cn">TRUE</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Processing the background scan files in this way is beyond the scope
of this vignette for now, since the functions that do the work are not
generalized enough to work for other set-ups.</p>
</div>
<div class="section level4">
<h4 id="spread-match">spread match<a class="anchor" aria-label="anchor" href="#spread-match"></a>
</h4>
<p>First we re-order the data into a wide format, where sample and
reference gas intensities are listed next to each other as separate
columns using the gather-unite-spread approach.</p>
<p>Then we compare reference gas to sample gas. With the
<code>method="normal"</code>, this would calculate the average of first
and second cycles for the reference gas. We can also use a
work-in-progress linear interpolation (<code>method="linterp"</code>) to
match the mass 44 intensity of the reference gas to that of the sample
gas and apply this same shift to all the other masses. At present, it
performs more poorly than the regular calculation though, probably due
to cycle elimination.</p>
<p>For example, we convert from the below:</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="18%">
<col width="9%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th><code>file_id</code></th>
<th>type</th>
<th>cycle</th>
<th>v44.mV</th>
<th>v45.mV</th>
<th>v46.mV</th>
<th>v47.mV</th>
<th>v54.mV</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"file_1.did"</code></td>
<td><code>"sample"</code></td>
<td>1</td>
<td>1200</td>
<td>1100</td>
<td>1000</td>
<td>5000</td>
<td>-302</td>
</tr>
<tr class="even">
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr class="odd">
<td><code>"file_1.did"</code></td>
<td><code>"standard"</code></td>
<td>0</td>
<td>1300</td>
<td>1100</td>
<td>1000</td>
<td>5000</td>
<td>-260</td>
</tr>
<tr class="even">
<td><code>"file_1.did"</code></td>
<td><code>"standard"</code></td>
<td>1</td>
<td>1200</td>
<td>1120</td>
<td>1020</td>
<td>5020</td>
<td>-230</td>
</tr>
</tbody>
</table>
<p>to the following output:</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="20%">
<col width="6%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th><code>file_id</code></th>
<th><code>file_datetime</code></th>
<th>cycle</th>
<th>s44</th>
<th>s45</th>
<th>s46</th>
<th>s47</th>
<th>s54</th>
<th>r44</th>
<th>r45</th>
<th>r46</th>
<th>r47</th>
<th>r54</th>
</tr></thead>
<tbody><tr class="odd">
<td><code>"file_1.did"</code></td>
<td>2019-03-01 12:00:00</td>
<td>1</td>
<td>1200</td>
<td>1100</td>
<td>1000</td>
<td>5000</td>
<td>-302</td>
<td>1250</td>
<td>1110</td>
<td>1010</td>
<td>5010</td>
<td>-245</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sprd</span> <span class="op">&lt;-</span> <span class="va">disc</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/spread_match.html">spread_match</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'disc' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="extract-reference-gas-d13c-and-d18o-values">extract reference gas d13C and d18O values<a class="anchor" aria-label="anchor" href="#extract-reference-gas-d13c-and-d18o-values"></a>
</h4>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">refd</span> <span class="op">&lt;-</span> <span class="va">sprd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/append_ref_deltas.html">append_ref_deltas</a></span><span class="op">(</span><span class="va">standards</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'sprd' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="calculate-little-deltas-and-clumped-values">calculate little deltaâ€™s and clumped values<a class="anchor" aria-label="anchor" href="#calculate-little-deltas-and-clumped-values"></a>
</h4>
<p>Now we can go to the bread and butter of clumpedr, delta
calculations!</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dlts</span> <span class="op">&lt;-</span> <span class="va">refd</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/abundance_ratios.html">abundance_ratios</a></span><span class="op">(</span><span class="va">s44</span>, <span class="va">s45</span>, <span class="va">s46</span>, <span class="va">s47</span>, <span class="va">s48</span>, <span class="va">s49</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/abundance_ratios.html">abundance_ratios</a></span><span class="op">(</span><span class="va">r44</span>, <span class="va">r45</span>, <span class="va">r46</span>, <span class="va">r47</span>, <span class="va">r48</span>, <span class="va">r49</span>,</span>
<span>                   <span class="va">R45_wg</span>, <span class="va">R46_wg</span>, <span class="va">R47_wg</span>, <span class="va">R48_wg</span>, <span class="va">R49_wg</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/little_deltas.html">little_deltas</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Mineralogy <span class="op">=</span> <span class="st">"Calcite"</span>, R18_PDB <span class="op">=</span> <span class="fu">clumpedr</span><span class="fu">:::</span><span class="fu">default</span><span class="op">(</span><span class="va">R18_PDB</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bulk_and_clumping_deltas.html">bulk_and_clumping_deltas</a></span><span class="op">(</span>R18_PDB <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">R18_PDB</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># outlier on the cycle level now contains all the reasons for cycle outliers</span></span>
<span>  <span class="fu"><a href="../reference/summarise_outlier.html">summarise_outlier</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'refd' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="collapse-cycles-calculate-averages-and-standard-deviations">collapse cycles: calculate averages and standard deviations<a class="anchor" aria-label="anchor" href="#collapse-cycles-calculate-averages-and-standard-deviations"></a>
</h4>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">coll</span> <span class="op">&lt;-</span> <span class="va">dlts</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">clumpedr</span><span class="fu">:::</span><span class="fu"><a href="../reference/collapse_cycles.html">collapse_cycles</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d13C_PDB</span>, <span class="va">d18O_PDB</span>, <span class="va">D47_raw</span><span class="op">)</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">file_id</span>, <span class="va">Analysis</span><span class="op">)</span><span class="op">)</span> <span class="co"># this is an older function which we will likely deprecate in the future in favour of:</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: collapsing cycles, calculating sample summaries.</span></span></code></pre>
<pre><code><span><span class="co">## defaulting to mean, sd, n, sem, and 95% cl</span></span></code></pre>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'dlts' not found</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co">## nest_cycle_data()</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="append-metadata">append metadata<a class="anchor" aria-label="anchor" href="#append-metadata"></a>
</h4>
<p>This just <code>left_join</code>s the metadata based on
<code>file_id</code>, so that we can use it for outlier removal etc.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dati</span> <span class="op">&lt;-</span> <span class="va">coll</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_info.html">add_info</a></span><span class="op">(</span><span class="va">stdinfo</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"file_root"</span>, <span class="st">"file_path"</span>, <span class="st">"file_subpath"</span>,</span>
<span>                             <span class="st">"file_datetime"</span>, <span class="st">"file_size"</span>, <span class="st">"Row"</span>,</span>
<span>                             <span class="st">"Peak Center"</span>, <span class="st">"Background"</span>, <span class="st">"Pressadjust"</span>,</span>
<span>                             <span class="st">"Reference Refill"</span>, <span class="st">"Line"</span>, <span class="st">"Sample"</span>,</span>
<span>                             <span class="st">"Weight [mg]"</span>, <span class="st">"Identifier 1"</span>, <span class="st">"Comment"</span>,</span>
<span>                             <span class="st">"Preparation"</span>, <span class="st">"Method"</span>, <span class="st">"measurement_info"</span>,</span>
<span>                             <span class="st">"MS_integration_time.s"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_info.html">add_info</a></span><span class="op">(</span><span class="va">inits</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s44_init"</span>, <span class="st">"r44_init"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'coll' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="remove-outliers">remove outliers<a class="anchor" aria-label="anchor" href="#remove-outliers"></a>
</h4>
<p>Based on several criteria, we can get rid of outliers. This needs to
happen before the Empirical Reference Frame is calculated and
applied.</p>
<p>Here we just filter outliers based on initial intensities.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rout</span> <span class="op">&lt;-</span> <span class="va">dati</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">cycle_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/find_init_outliers.html">find_init_outliers</a></span><span class="op">(</span>init_low <span class="op">=</span> <span class="fl">4000</span>, init_high <span class="op">=</span> <span class="fl">40000</span>, init_diff <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'dati' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="empirical-transfer-function">empirical transfer function<a class="anchor" aria-label="anchor" href="#empirical-transfer-function"></a>
</h4>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">detf</span> <span class="op">&lt;-</span> <span class="va">rout</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/empirical_transfer_function.html">empirical_transfer_function</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: calculating and applying Emperical Transfer Function, with D47_raw as a function of expected_D47, for each Preparation.</span></span></code></pre>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'rout' not found</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="temperature-calculation">temperature calculation<a class="anchor" aria-label="anchor" href="#temperature-calculation"></a>
</h4>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">detf</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/temperature_calculation.html">temperature_calculation</a></span><span class="op">(</span>D47 <span class="op">=</span> <span class="va">D47_etf</span>, slope <span class="op">=</span> <span class="fl">0.0397</span>, intercept <span class="op">=</span> <span class="fl">0.1518</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> Failed to evaluate glue component {unique(.data[, slope])}</span></span>
<span><span class="co">## <span style="font-weight: bold;">Caused by error:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> object 'detf' not found</span></span></code></pre>
<p>Note that in the case of many small replicates, it is better to do
your analysis based on the D47 in stead of on aliquot temperatures.
Furthermore, error propagation of the calibration uncertainty is not
incorporated here.</p>
</div>
</div>
<div class="section level3">
<h3 id="plots-and-summary">plots and summary<a class="anchor" aria-label="anchor" href="#plots-and-summary"></a>
</h3>
<p>We can create some summary plots, i.e.Â of the temperature per
standard:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a tibble that holds heights for text annotations</span></span>
<span><span class="va">summ</span> <span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">`Identifier 1`</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">D47_etf</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.05</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'temp' not found</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Identifier 1`</span>, y <span class="op">=</span> <span class="va">D47_etf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">`Identifier 1`</span>, fill <span class="op">=</span> <span class="va">`Identifier 1`</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.05</span>, alpha <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">`Identifier 1`</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">n</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">summ</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'temp' not found</span></span></code></pre>
<p>If you do not understand any of the steps, look at the function
documentation (e.g.: <code><a href="../reference/empirical_transfer_function.html">?empirical_transfer_function</a></code>) or look
at the source code (type the function name without parentheses into the
command line).</p>
<p>Enjoy!</p>
<p>Here are all the steps in one pipeline:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stdinfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_get_file_info.html" class="external-link">iso_get_file_info</a></span><span class="op">(</span><span class="va">standards</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: aggregating file info from 27 data file(s)</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_inits.html">get_inits</a></span><span class="op">(</span><span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_get_raw_data.html" class="external-link">iso_get_raw_data</a></span><span class="op">(</span><span class="va">standards</span>, include_file_info <span class="op">=</span> <span class="st">"Analysis"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: aggregating raw data from 27 data file(s), including file info '"Analysis"'</span></span></code></pre>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">standards</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_filter_files.html" class="external-link">iso_filter_files</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Clumped.*met"</span>, <span class="va">Method</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="http://isoreader.isoverse.org/reference/iso_get_raw_data.html" class="external-link">iso_get_raw_data</a></span><span class="op">(</span>include_file_info <span class="op">=</span> <span class="st">"Analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dis_min <span class="op">=</span> <span class="fl">500</span>, dis_max <span class="op">=</span> <span class="fl">50000</span>, dis_fac <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/find_bad_cycles.html">find_bad_cycles</a></span><span class="op">(</span>min <span class="op">=</span> <span class="st">"dis_min"</span>, max <span class="op">=</span> <span class="st">"dis_max"</span>,</span>
<span>                  fac <span class="op">=</span> <span class="st">"dis_fac"</span>, relative_to <span class="op">=</span> <span class="st">"init"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/correct_backgrounds.html">correct_backgrounds</a></span><span class="op">(</span><span class="fl">0.82</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/spread_match.html">spread_match</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/append_ref_deltas.html">append_ref_deltas</a></span><span class="op">(</span><span class="va">standards</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/abundance_ratios.html">abundance_ratios</a></span><span class="op">(</span><span class="va">s44</span>, <span class="va">s45</span>, <span class="va">s46</span>, <span class="va">s47</span>, <span class="va">s48</span>, <span class="va">s49</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/abundance_ratios.html">abundance_ratios</a></span><span class="op">(</span><span class="va">r44</span>, <span class="va">r45</span>, <span class="va">r46</span>, <span class="va">r47</span>, <span class="va">r48</span>, <span class="va">r49</span>,</span>
<span>                   <span class="va">R45_wg</span>, <span class="va">R46_wg</span>, <span class="va">R47_wg</span>, <span class="va">R48_wg</span>, <span class="va">R49_wg</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/little_deltas.html">little_deltas</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Mineralogy <span class="op">=</span> <span class="st">"Calcite"</span>, R18_PDB <span class="op">=</span> <span class="fu">clumpedr</span><span class="fu">:::</span><span class="fu">default</span><span class="op">(</span><span class="va">R18_PDB</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/bulk_and_clumping_deltas.html">bulk_and_clumping_deltas</a></span><span class="op">(</span>R18_PDB <span class="op">=</span> <span class="va">.data</span><span class="op">$</span><span class="va">R18_PDB</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># outlier on the cycle level now contains all the reasons for cycle outliers</span></span>
<span>  <span class="fu"><a href="../reference/summarise_outlier.html">summarise_outlier</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/collapse_cycles.html">collapse_cycles</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">d18O_PDBCO2</span>, <span class="va">d13C_PDB</span>, <span class="va">D47_raw</span><span class="op">)</span>, id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">file_id</span>, <span class="va">Analysis</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_info.html">add_info</a></span><span class="op">(</span><span class="va">stdinfo</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"file_root"</span>, <span class="st">"file_path"</span>, <span class="st">"file_subpath"</span>,</span>
<span>                             <span class="st">"file_datetime"</span>, <span class="st">"file_size"</span>, <span class="st">"Row"</span>,</span>
<span>                             <span class="st">"Peak Center"</span>, <span class="st">"Background"</span>, <span class="st">"Pressadjust"</span>,</span>
<span>                             <span class="st">"Reference Refill"</span>, <span class="st">"Line"</span>, <span class="st">"Sample"</span>,</span>
<span>                             <span class="st">"Weight [mg]"</span>, <span class="st">"Identifier 1"</span>, <span class="st">"Comment"</span>,</span>
<span>                             <span class="st">"Preparation"</span>, <span class="st">"Method"</span>, <span class="st">"measurement_info"</span>,</span>
<span>                             <span class="st">"MS_integration_time.s"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_info.html">add_info</a></span><span class="op">(</span><span class="va">inits</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s44_init"</span>, <span class="st">"r44_init"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">cycle_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/find_init_outliers.html">find_init_outliers</a></span><span class="op">(</span>init_low <span class="op">=</span> <span class="fl">4000</span>, init_high <span class="op">=</span> <span class="fl">40000</span>, init_diff <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/empirical_transfer_function.html">empirical_transfer_function</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/temperature_calculation.html">temperature_calculation</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">0.0397</span>, intercept <span class="op">=</span> <span class="fl">0.1518</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: calculating and applying Emperical Transfer Function, with D47_raw as a function of expected_D47, for each Preparation.</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> Failed to evaluate glue component {unique(.data[, slope])}</span></span>
<span><span class="co">## <span style="font-weight: bold;">Caused by error in `collapse_cycles()`:</span></span></span>
<span><span class="co">## <span style="color: #BBBB00;">!</span> could not find function "collapse_cycles"</span></span></code></pre>
<div class="section level4">
<h4 id="hint-look-at-plots-interactively">HINT: look at plots interactively<a class="anchor" aria-label="anchor" href="#hint-look-at-plots-interactively"></a>
</h4>
<p>Note that it is very nice to look at this plotâ€”or any of the future
onesâ€”interactively using <code>ggplotly</code>:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/toWebGL.html" class="external-link">toWebGL</a></span><span class="op">(</span><span class="fu">plotly</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plotly/man/ggplotly.html" class="external-link">ggplotly</a></span><span class="op">(</span>dynamicTicks <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This creates an interactive version of the last plot in your
browser.</p>
<p>You can also assign extra aesthetics that you do not directly see to
your plot, for example <code>aes(ID = file_id, no = Analysis)</code> and
this information will show up when you hover a point.</p>
<p>Note that we use the <code>toWebGL</code> wrapper to make it run
smoother for plots with many points.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ilja Kocken.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
